<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados da Pesquisa</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Resultados da Pesquisa</h1>
    <div id="movies-container"></div>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const title = urlParams.get("title");

            if (!title) {
                alert("Nenhum título de filme fornecido!");
                return;
            }

            try {
                const response = await fetch(`http://localhost:5500/get_film/${title}`);
                const data = await response.json();

                if (response.ok) {
                    const moviesContainer = document.getElementById("movies-container");

                    data.movies.forEach(movie => {
                        const movieElement = document.createElement("div");
                        movieElement.className = "movie";

                        const posterImage = movie.image !== "Imagem não encontrada" && movie.image !== "N/A" 
                            ? movie.image 
                            : "https://via.placeholder.com/200";

                        movieElement.innerHTML = `
                            <img src="${posterImage}" alt="${movie.title}" />
                            <h3>${movie.title}</h3>
                            <p><strong>Nota:</strong> ${movie.vote_average || "N/A"}</p>
                        `;

                        // Certifique-se de passar o 'id' correto aqui.
                        movieElement.addEventListener("click", () => {
                            // Altere o parâmetro para passar o ID correto
                            window.location.href = `details.html?id=${movie.title}`; // Usar o 'title' para identificar
                        });

                        moviesContainer.appendChild(movieElement);
                    });
                } else {
                    alert(data.error || "Erro ao buscar os filmes.");
                }
            } catch (error) {
                console.error("Erro no frontend:", error);
                alert("Erro ao buscar os filmes. Tente novamente mais tarde.");
            }
        });
    </script>
</body>
</html>
